{% extends 'base.html' %}

{% load static %}
{% load humanize %}

{% block content %}

<div class="split left"> 
    <div class="columns is-mobile is-centered">
        <div class="column">

            <div class="card" style="width: 70%; margin-left: 200px;">
                <div class="card-image">

                    <div class="slideshow-container">

                        {% for cont in post.content.all %}
                        <!-- Full-width images with number and caption text -->
                        <div class="mySlides fade">
                            {% if cont.file.name|slice:"-3:" == 'jpg' or cont.file.name|slice:"-3:" == 'png' %}
                            <figure class="image is-4by3">
                                <a href="{{ cont.get_absolute_url }}">
                                    <img src="{{ cont.file.url }}" alt="Placeholder image">
                                </a>
                            </figure>
                            {% else %}
                            <a href="{{ cont.get_absolute_url }}">
                                <video width="640" controls="controls" preload="metadata">
                                    <source src="{{ cont.file.url }}#t=0.5" type="video/mp4">        
                                </video>      
                            </a>
                            {% endif %}
                        </div>
                        {% endfor %}

                        <!-- Next and previous buttons -->
                        <a class="prev" onclick="plusSlides(-1)">&#10094;</a>
                        <a class="next" onclick="plusSlides(1)">&#10095;</a>
                    </div> 

                </div> 

                <div class="card-content">
                    <div class="media">

                        <div class="media-left">
                            <figure class="image is-48x48">
                                <a href="{% url 'profile' post.user %}"> 
                                    {% if post.user.profile.picture %}
                                    <img class="box_badge_picture" src="{{ post.user.profile.picture.url }}">
                                    {% else %}
                                    <img class="box_badge_picture" src="{% static 'img/TeamUpNow_logo_Whiteackground - Copy.png' %}" alt="Placeholder image">
                                    {% endif %}
                                </a>
                            </figure>
                        </div>

                        <div class="media-content"> 
                            <title_header_Notification_date>{{ post.posted }}</title_header_Notification_date>
                            {% if post.user.profile.first_name %} 
                            <p><title_header_PostDetails>{{ post.user.profile.first_name }} {{ post.user.profile.last_name }}</title_header_PostDetails></p> 
                            {% else %}
                            <title_header_PostDetails>{{ post.user.profile.user }}</title_header_PostDetails>
                            {% endif %} 

                            <div>{{ post.title_post }}</div> 
                            <div>{{ post.caption }} </div>
                            <p>{% for tag in post.tags.all %}<a href="{{ tag.get_absolute_url }}">#{{ tag }}</a>{% endfor %} </p>
                            <p><a href='{{ post.url_sourceContent }}'>See Source Of The tutorial</a> about {{ post.title_post }}</p>
                        </div>

                        {% if user.is_authenticated and user != post.user %}
                        {% if favorited is True %}
                        <div class="media-right">
                            <a href="{% url 'postfavorite' post.id %}"><title_header_Post_unfollow>Unfollow classes</title_header_Post_unfollow></a> 
                        </div>
                        {% else %}
                        <div class="media-right">
                            <a href="{% url 'postfavorite' post.id %}"><title_header_Post_follow>Follow Content</title_header_Post_follow></a> 
                        </div>
                        {% endif %} 

                        <div class="media-right">
                            <a href="{% url 'post_interested' post.id %}"><title_header_Post_interested>Interested {{ interested }}</title_header_Post_interested><a>
                        </div>

                        <div class="media-right">
                            <a href="{% url 'post_liked' post.id %}"><title_header_Post_liked>Liked {{ liked }}</title_header_Post_liked></a>
                        </div> 

                        {% endif %} 

                        {% if user.is_authenticated and user == post.user %}
                        {% if user.is_authenticated %} 
                        <div class="media-right">
                            <a href="{% url 'edit_post' post.id %}" class="btn btn-outline-secondary btn-sm">
                                <title_header>Edit</title_header>
                            </a> 
                        </div> 

                        <div class="media-right">
                            <a href="{% url 'pre_delete_post' post.id %}">
                                <title_header>Delete</title_header> 
                            </a>
                        </div>  
                        <br>
                        {% endif %} 
                        {% endif %}  
                    </div>
                </div>

                <div class="card-content">

                    {% for comment in comments %}
                    <article class="media">
                        <figure class="media-left">
                            <a href="{% url 'profile' comment.user %}"> 
                                <p class="image is-64x64">
                                    {% if comment.user.profile.picture %}
                                    <img class="box_badge_picture" src="{{ comment.user.profile.picture.url }}">
                                    {% else %}
                                    <img class="box_badge_picture" src="{% static 'img/TeamUpNow_logo_Whiteackground - Copy.png' %}" alt="Placeholder image">
                                    {% endif %}
                                </p>
                            </a>
                        </figure>

                        <div class="media-content">
                            <div class="content">
                                <title_header_Notification_date>{{ comment.date|naturaltime }}</title_header_Notification_date>
                                <p>
                                    {% if comment.user.profile.first_name %}
                                    <title_header_PostDetails>{{ comment.user.profile.first_name }} {{ comment.user.profile.last_name }}</title_header_PostDetails>
                                    {% else %}
                                    <title_header_PostDetails>{{ post.user.profile.user }}</title_header_PostDetails>
                                    {% endif %}

                                    <p>{{ comment.body }}</p>
                                </p>
                            </div>
                    </article>
                    {% endfor %}

                    <article class="media">
                        <figure class="media-left">
                            <a href="{% url 'profile' user %}"> 
                                <p class="image is-64x64">
                                    {% if request.user.profile.picture %}
                                    <img class="box_badge_picture" src="{{ request.user.profile.picture.url }}">
                                    {% else %}
                                    <img class="box_badge_picture" src="{% static 'img/TeamUpNow_logo_Whiteackground - Copy.png' %}" alt="Placeholder image">
                                    {% endif %}
                                </p>
                            </a>
                        </figure>
                        <div class="media-content">
                            <form method="post" action="" role="form">
                                {% csrf_token %}
                                <div class="field">
                                    <p class="control">
                                        <title_header_Notification_date>Leave your comment here:</title_header_Notification_date> {{ form.body }}
                                    </p>
                                </div>
                                <div class="field">
                                    <button type="submit" class="createAccountPage-button">
                                        Post comment 
                                    </button>
                                </div>
                            </form>
                        </div>
                    </article>
                </div>

            </div>
        </div>

    </div>
</div>

{% endblock %}
